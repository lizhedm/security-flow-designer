<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>研判知识库</title>
    <link href="../lib/css/tailwind.min.css" rel="stylesheet">
    <link href="../lib/fontawesome/css/fontawesome.min.css" rel="stylesheet">
    <script src="../lib/js/alpine.min.js" defer></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body class="bg-gray-50 p-6">
    <div class="mb-6">
        <h1 class="text-2xl font-bold mb-4">研判知识库</h1>
        
        <!-- 搜索框 -->
        <div class="bg-white rounded-xl shadow-sm p-4 mb-6">
            <div class="relative">
                <input type="text" placeholder="搜索知识库要素..." 
                    class="w-full pl-10 pr-4 py-3 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                <i class="fas fa-search absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400 text-lg"></i>
            </div>
        </div>

        <!-- 标签统计 -->
        <div class="bg-white rounded-xl shadow-sm p-4 mb-6">
            <div class="flex flex-wrap gap-2">
                <span class="text-sm text-gray-500">标签：</span>
                <button class="px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm hover:bg-blue-200">
                    Web安全 (23)
                </button>
                <button class="px-3 py-1 bg-red-100 text-red-800 rounded-full text-sm hover:bg-red-200">
                    高危漏洞 (15)
                </button>
                <button class="px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm hover:bg-green-200">
                    处置方案 (8)
                </button>
                <button class="px-3 py-1 bg-yellow-100 text-yellow-800 rounded-full text-sm hover:bg-yellow-200">
                    攻击模式 (12)
                </button>
                <button class="px-3 py-1 bg-purple-100 text-purple-800 rounded-full text-sm hover:bg-purple-200">
                    漏洞利用 (6)
                </button>
            </div>
        </div>

        <!-- 知识卡片列表 -->
        <div class="grid grid-cols-1 gap-4">
            <!-- 知识卡片 1 -->
            <div class="bg-white rounded-xl shadow-sm p-6 hover:shadow-md transition-shadow duration-200">
                <div class="flex justify-between items-start mb-4">
                    <div>
                        <h3 class="text-lg font-medium text-gray-900 mb-2">SQL注入特征分析</h3>
                        <div class="flex items-center space-x-4 text-sm text-gray-500">
                            <span>类型：漏洞</span>
                            <span>创建人：张三</span>
                            <span>创建时间：2024-03-15</span>
                            <span>更新时间：2024-03-16</span>
                        </div>
                    </div>
                    <div class="flex space-x-2">
                        <button class="px-4 py-2 text-sm text-blue-600 hover:bg-blue-50 rounded-lg transition-colors duration-200">
                            <i class="fas fa-eye mr-1"></i> 查看详情
                        </button>
                        <button class="px-4 py-2 text-sm text-blue-600 hover:bg-blue-50 rounded-lg transition-colors duration-200">
                            <i class="fas fa-link mr-1"></i> 复制详情链接
                        </button>
                        <button class="px-4 py-2 text-sm text-blue-600 hover:bg-blue-50 rounded-lg transition-colors duration-200">
                            <i class="fas fa-copy mr-1"></i> 一键复用
                        </button>
                        <button class="px-4 py-2 text-sm text-blue-600 hover:bg-blue-50 rounded-lg transition-colors duration-200">
                            <i class="fas fa-edit mr-1"></i> 编辑
                        </button>
                        <button class="px-4 py-2 text-sm text-red-600 hover:bg-red-50 rounded-lg transition-colors duration-200">
                            <i class="fas fa-trash mr-1"></i> 删除
                        </button>
                    </div>
                </div>
                <div class="mb-4">
                    <div class="flex flex-wrap gap-2 mb-2">
                        <span class="px-2 py-1 bg-blue-100 text-blue-800 rounded-full text-xs">Web安全</span>
                        <span class="px-2 py-1 bg-red-100 text-red-800 rounded-full text-xs">高危漏洞</span>
                        <span class="px-2 py-1 bg-yellow-100 text-yellow-800 rounded-full text-xs">攻击模式</span>
                    </div>
                    <p class="text-gray-600 text-sm line-clamp-3">
                        1. 检查URL参数中是否包含SQL关键字<br>
                        2. 分析请求参数中的特殊字符<br>
                        3. 验证数据库响应时间<br>
                        4. 检查错误信息泄露<br>
                        5. 分析HTTP响应头信息<br>
                    </p>
                </div>
                <div>
                    <h3 class="text-lg font-medium text-gray-900 mb-2">附件列表</h3>
                </div>
                <!-- 证据信息 -->
                <div>
                    <div class="space-y-2">
                        <div class="flex items-center space-x-2">
                            <i class="fas fa-file-alt text-gray-400"></i>
                            <span class="text-sm text-blue-600 hover:text-blue-800 cursor-pointer">网络数据包.pcap</span>
                            <i class="fas fa-file-code text-gray-400"></i>
                            <span class="text-sm text-blue-600 hover:text-blue-800 cursor-pointer">异常日志.log</span>
                            <i class="fas fa-image text-gray-400"></i>
                            <span class="text-sm text-blue-600 hover:text-blue-800 cursor-pointer">攻击截图.png</span>
                        </div>
                    </div>
                </div>
                <div class="border-t border-gray-200 my-4"></div>
                <div>
                    <h1 class="text-lg font-medium text-gray-900 mb-2">分析步骤</h3>
                </div>
                <!-- 步骤条 -->
                <div class="steps-container">
                    <div class="flex justify-between pb-8">
                        <!-- Ping工具步骤 -->
                        <div class="step relative flex flex-col items-center w-1/3">
                            <div class="step-icon mb-2 relative group" onmouseover="showDelete(this)" onmouseout="hideDelete(this)">
                                <i class="fas fa-exchange-alt text-1xl text-blue-600 p-3 bg-blue-50 rounded-full"></i>
                                <button class="delete-btn absolute -top-2 -right-2 opacity-0 transition-opacity" 
                                        onclick="deleteStep(0)">
                                    <i class="fas fa-times-circle text-red-500 bg-white rounded-full"></i>
                                </button>
                            </div>
                            <span class="text-sm text-gray-700">Ping工具</span>
                            <div class="absolute top-5 left-1/2 w-full h-0.5 bg-gray-200 -z+10"></div>
                        </div>

                        <!-- 漏洞验证步骤 -->
                        <div class="step relative flex flex-col items-center w-1/3">
                            <div class="step-icon mb-2 relative group" onmouseover="showDelete(this)" onmouseout="hideDelete(this)">
                                <i class="fas fa-search text-1xl text-green-600 p-3 bg-green-50 rounded-full"></i>
                                <button class="delete-btn absolute -top-2 -right-2 opacity-0 transition-opacity" 
                                        onclick="deleteStep(1)">
                                    <i class="fas fa-times-circle text-red-500 bg-white rounded-full"></i>
                                </button>
                            </div>
                            <span class="text-sm text-gray-700">漏洞验证</span>
                            <div class="absolute top-5 left-1/2 w-full h-0.5 bg-gray-200 -z+10"></div>
                        </div>

                        <!-- ClamAV工具步骤 -->
                        <div class="step relative flex flex-col items-center w-1/3">
                            <div class="step-icon mb-2 relative group" onmouseover="showDelete(this)" onmouseout="hideDelete(this)">
                                <i class="fas fa-virus-slash text-1xl text-red-600 p-3 bg-red-50 rounded-full"></i>
                                <button class="delete-btn absolute -top-2 -right-2 opacity-0 transition-opacity" 
                                        onclick="deleteStep(2)">
                                    <i class="fas fa-times-circle text-red-500 bg-white rounded-full"></i>
                                </button>
                            </div>
                            <span class="text-sm text-gray-700">ClamAV工具</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 知识卡片 2 -->
            <div class="bg-white rounded-xl shadow-sm p-6 hover:shadow-md transition-shadow duration-200">
                <div class="flex justify-between items-start mb-4">
                    <div>
                        <h3 class="text-lg font-medium text-gray-900 mb-2">可疑的外连行为</h3>
                        <div class="flex items-center space-x-4 text-sm text-gray-500">
                            <span>类型：外连行为</span>
                            <span>创建人：张三</span>
                            <span>创建时间：2024-03-15</span>
                            <span>更新时间：2024-03-16</span>
                        </div>
                    </div>
                    <div class="flex space-x-2">
                        <button class="px-4 py-2 text-sm text-blue-600 hover:bg-blue-50 rounded-lg transition-colors duration-200">
                            <i class="fas fa-eye mr-1"></i> 查看详情
                        </button>
                        <button class="px-4 py-2 text-sm text-blue-600 hover:bg-blue-50 rounded-lg transition-colors duration-200">
                            <i class="fas fa-link mr-1"></i> 复制详情链接
                        </button>
                        <button class="px-4 py-2 text-sm text-blue-600 hover:bg-blue-50 rounded-lg transition-colors duration-200">
                            <i class="fas fa-copy mr-1"></i> 一键复用
                        </button>
                        <button class="px-4 py-2 text-sm text-blue-600 hover:bg-blue-50 rounded-lg transition-colors duration-200">
                            <i class="fas fa-edit mr-1"></i> 编辑
                        </button>
                        <button class="px-4 py-2 text-sm text-red-600 hover:bg-red-50 rounded-lg transition-colors duration-200">
                            <i class="fas fa-trash mr-1"></i> 删除
                        </button>
                    </div>
                </div>
                <div class="mb-4">
                    <div class="flex flex-wrap gap-2 mb-2">
                        <span class="px-2 py-1 bg-blue-100 text-blue-800 rounded-full text-xs">Web安全</span>
                        <span class="px-2 py-1 bg-green-100 text-green-800 rounded-full text-xs">处置方案</span>
                    </div>
                    <p class="text-gray-600 text-sm line-clamp-3">
                        1. 检查请求头中的Referer字段<br>
                        2. 分析请求参数中的URL<br>
                        3. 验证目标网站的合法性<br>
                        4. 检查HTTP响应头中的Location字段<br>
                        5. 定期安全扫描<br>
                    </p>
                </div>
                <div>
                    <h1 class="text-lg font-medium text-gray-900 mb-2">附件列表</h3>
                </div>
                <!-- 证据信息 -->
                <div>
                    <div class="space-y-2">
                        <div class="flex items-center space-x-2">
                            <i class="fas fa-file-alt text-gray-400"></i>
                            <span class="text-sm text-blue-600 hover:text-blue-800 cursor-pointer">网络数据包.pcap</span>
                            <i class="fas fa-file-code text-gray-400"></i>
                            <span class="text-sm text-blue-600 hover:text-blue-800 cursor-pointer">异常日志.log</span>
                            <i class="fas fa-image text-gray-400"></i>
                            <span class="text-sm text-blue-600 hover:text-blue-800 cursor-pointer">攻击截图.png</span>
                        </div>
                    </div>
                </div>
                <div class="border-t border-gray-200 my-4"></div>
                <div>
                    <h1 class="text-lg font-medium text-gray-900 mb-2">分析步骤</h3>
                </div>
                 <!-- 步骤条 -->
                 <div class="steps-container">
                    <div class="flex justify-between pb-8">
                        <!-- Ping工具步骤 -->
                        <div class="step relative flex flex-col items-center w-1/3">
                            <div class="step-icon mb-2 relative group" onmouseover="showDelete(this)" onmouseout="hideDelete(this)">
                                <i class="fas fa-exchange-alt text-1xl text-blue-600 p-3 bg-blue-50 rounded-full"></i>
                                <button class="delete-btn absolute -top-2 -right-2 opacity-0 transition-opacity" 
                                        onclick="deleteStep(0)">
                                    <i class="fas fa-times-circle text-red-500 bg-white rounded-full"></i>
                                </button>
                            </div>
                            <span class="text-sm text-gray-700">Ping工具</span>
                            <div class="absolute top-5 left-1/2 w-full h-0.5 bg-gray-200 -z+10"></div>
                        </div>

                        <!-- 漏洞验证步骤 -->
                        <div class="step relative flex flex-col items-center w-1/3">
                            <div class="step-icon mb-2 relative group" onmouseover="showDelete(this)" onmouseout="hideDelete(this)">
                                <i class="fas fa-search text-1xl text-green-600 p-3 bg-green-50 rounded-full"></i>
                                <button class="delete-btn absolute -top-2 -right-2 opacity-0 transition-opacity" 
                                        onclick="deleteStep(1)">
                                    <i class="fas fa-times-circle text-red-500 bg-white rounded-full"></i>
                                </button>
                            </div>
                            <span class="text-sm text-gray-700">漏洞验证</span>
                            <div class="absolute top-5 left-1/2 w-full h-0.5 bg-gray-200 -z+10"></div>
                        </div>

                        <!-- ClamAV工具步骤 -->
                        <div class="step relative flex flex-col items-center w-1/3">
                            <div class="step-icon mb-2 relative group" onmouseover="showDelete(this)" onmouseout="hideDelete(this)">
                                <i class="fas fa-virus-slash text-1xl text-red-600 p-3 bg-red-50 rounded-full"></i>
                                <button class="delete-btn absolute -top-2 -right-2 opacity-0 transition-opacity" 
                                        onclick="deleteStep(2)">
                                    <i class="fas fa-times-circle text-red-500 bg-white rounded-full"></i>
                                </button>
                            </div>
                            <span class="text-sm text-gray-700">ClamAV工具</span>
                        </div>
                    </div>
                </div>
            </div>
            <!-- 知识卡片 3 -->
            <div class="bg-white rounded-xl shadow-sm p-6 hover:shadow-md transition-shadow duration-200">
                <div class="flex justify-between items-start mb-4">
                    <div>
                        <h3 class="text-lg font-medium text-gray-900 mb-2">XSS攻击处置方案</h3>
                        <div class="flex items-center space-x-4 text-sm text-gray-500">
                            <span>类型：处置方案</span>
                            <span>创建人：李四</span>
                            <span>创建时间：2024-03-14</span>
                            <span>更新时间：2024-03-15</span>
                        </div>
                    </div>
                    <div class="flex space-x-2">
                        <button class="px-4 py-2 text-sm text-blue-600 hover:bg-blue-50 rounded-lg transition-colors duration-200">
                            <i class="fas fa-eye mr-1"></i> 查看详情
                        </button>
                        <button class="px-4 py-2 text-sm text-blue-600 hover:bg-blue-50 rounded-lg transition-colors duration-200">
                            <i class="fas fa-link mr-1"></i> 复制详情链接
                        </button>
                        <button class="px-4 py-2 text-sm text-blue-600 hover:bg-blue-50 rounded-lg transition-colors duration-200">
                            <i class="fas fa-copy mr-1"></i> 一键复用
                        </button>
                        <button class="px-4 py-2 text-sm text-blue-600 hover:bg-blue-50 rounded-lg transition-colors duration-200">
                            <i class="fas fa-edit mr-1"></i> 编辑
                        </button>
                        <button class="px-4 py-2 text-sm text-red-600 hover:bg-red-50 rounded-lg transition-colors duration-200">
                            <i class="fas fa-trash mr-1"></i> 删除
                        </button>
                    </div>
                </div>
                <div class="mb-4">
                    <div class="flex flex-wrap gap-2 mb-2">
                        <span class="px-2 py-1 bg-blue-100 text-blue-800 rounded-full text-xs">Web安全</span>
                        <span class="px-2 py-1 bg-green-100 text-green-800 rounded-full text-xs">处置方案</span>
                    </div>
                    <p class="text-gray-600 text-sm line-clamp-3">
                        1. 对输入数据进行HTML转义<br>
                        2. 设置CSP安全策略<br>
                        3. 启用HttpOnly Cookie<br>
                        4. 实施XSS过滤器<br>
                        5. 定期安全扫描<br>
                    </p>
                </div>
                <div>
                    <h1 class="text-lg font-medium text-gray-900 mb-2">附件列表</h3>
                </div>
                <!-- 证据信息 -->
                <div>
                    <div class="space-y-2">
                        <div class="flex items-center space-x-2">
                            <i class="fas fa-file-alt text-gray-400"></i>
                            <span class="text-sm text-blue-600 hover:text-blue-800 cursor-pointer">网络数据包.pcap</span>
                            <i class="fas fa-file-code text-gray-400"></i>
                            <span class="text-sm text-blue-600 hover:text-blue-800 cursor-pointer">异常日志.log</span>
                            <i class="fas fa-image text-gray-400"></i>
                            <span class="text-sm text-blue-600 hover:text-blue-800 cursor-pointer">攻击截图.png</span>
                        </div>
                    </div>
                </div>
                <div class="border-t border-gray-200 my-4"></div>
                <div>
                    <h1 class="text-lg font-medium text-gray-900 mb-2">分析步骤</h3>
                </div>
                 <!-- 步骤条 -->
                 <div class="steps-container">
                    <div class="flex justify-between pb-8">
                        <!-- Ping工具步骤 -->
                        <div class="step relative flex flex-col items-center w-1/3">
                            <div class="step-icon mb-2 relative group" onmouseover="showDelete(this)" onmouseout="hideDelete(this)">
                                <i class="fas fa-exchange-alt text-1xl text-blue-600 p-3 bg-blue-50 rounded-full"></i>
                                <button class="delete-btn absolute -top-2 -right-2 opacity-0 transition-opacity" 
                                        onclick="deleteStep(0)">
                                    <i class="fas fa-times-circle text-red-500 bg-white rounded-full"></i>
                                </button>
                            </div>
                            <span class="text-sm text-gray-700">Ping工具</span>
                            <div class="absolute top-5 left-1/2 w-full h-0.5 bg-gray-200 -z+10"></div>
                        </div>

                        <!-- 漏洞验证步骤 -->
                        <div class="step relative flex flex-col items-center w-1/3">
                            <div class="step-icon mb-2 relative group" onmouseover="showDelete(this)" onmouseout="hideDelete(this)">
                                <i class="fas fa-search text-1xl text-green-600 p-3 bg-green-50 rounded-full"></i>
                                <button class="delete-btn absolute -top-2 -right-2 opacity-0 transition-opacity" 
                                        onclick="deleteStep(1)">
                                    <i class="fas fa-times-circle text-red-500 bg-white rounded-full"></i>
                                </button>
                            </div>
                            <span class="text-sm text-gray-700">漏洞验证</span>
                            <div class="absolute top-5 left-1/2 w-full h-0.5 bg-gray-200 -z+10"></div>
                        </div>

                        <!-- ClamAV工具步骤 -->
                        <div class="step relative flex flex-col items-center w-1/3">
                            <div class="step-icon mb-2 relative group" onmouseover="showDelete(this)" onmouseout="hideDelete(this)">
                                <i class="fas fa-virus-slash text-1xl text-red-600 p-3 bg-red-50 rounded-full"></i>
                                <button class="delete-btn absolute -top-2 -right-2 opacity-0 transition-opacity" 
                                        onclick="deleteStep(2)">
                                    <i class="fas fa-times-circle text-red-500 bg-white rounded-full"></i>
                                </button>
                            </div>
                            <span class="text-sm text-gray-700">ClamAV工具</span>
                        </div>
                    </div>
                </div>
            </div>
            
            </div>
        </div>

        <!-- 分页 -->
        <div class="flex justify-between items-center mt-4">
            <div class="text-sm text-gray-500">
                显示 1-2 条，共 2 条
            </div>
            <div class="flex space-x-2">
                <button class="px-3 py-1 border rounded hover:bg-gray-50">&lt;</button>
                <button class="px-3 py-1 border rounded bg-blue-600 text-white">1</button>
                <button class="px-3 py-1 border rounded hover:bg-gray-50">2</button>
                <button class="px-3 py-1 border rounded hover:bg-gray-50">3</button>
                <button class="px-3 py-1 border rounded hover:bg-gray-50">&gt;</button>
            </div>
        </div>
    </div>

    <!-- 标签管理弹窗 -->
    <div id="tagDialog" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white rounded-lg shadow-xl w-[500px]">
            <div class="flex justify-between items-center p-6 border-b">
                <h3 class="text-lg font-medium">标签管理</h3>
                <button onclick="closeTagDialog()" class="text-gray-400 hover:text-gray-500">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="p-6 space-y-4">
                <div class="space-y-2">
                    <label class="text-sm text-gray-700">新增标签</label>
                    <div class="flex space-x-2">
                        <input type="text" class="flex-1 px-3 py-2 border rounded-lg" placeholder="输入标签名称">
                        <button class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700">添加</button>
                    </div>
                </div>
                <div class="space-y-2">
                    <label class="text-sm text-gray-700">已有标签</label>
                    <div class="space-y-2">
                        <div class="flex items-center justify-between p-2 hover:bg-gray-50 rounded">
                            <div class="flex items-center space-x-2">
                                <span class="px-2 py-1 bg-blue-100 text-blue-800 rounded-full text-xs">Web安全</span>
                                <span class="text-sm text-gray-500">(23)</span>
                            </div>
                            <div class="flex space-x-2">
                                <button class="text-blue-600 hover:text-blue-800">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button class="text-red-600 hover:text-red-800">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </div>
                        <div class="flex items-center justify-between p-2 hover:bg-gray-50 rounded">
                            <div class="flex items-center space-x-2">
                                <span class="px-2 py-1 bg-red-100 text-red-800 rounded-full text-xs">高危漏洞</span>
                                <span class="text-sm text-gray-500">(15)</span>
                            </div>
                            <div class="flex space-x-2">
                                <button class="text-blue-600 hover:text-blue-800">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button class="text-red-600 hover:text-red-800">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="flex justify-end p-6 border-t bg-gray-50">
                <button onclick="closeTagDialog()" class="px-4 py-2 text-gray-600 hover:text-gray-800">关闭</button>
            </div>
        </div>
    </div>

    <script>
        // 添加消息监听器，接收来自template.html的消息并转发给home.html
        window.addEventListener('message', function(event) {
            // 转发消息给顶层窗口
            if (event.data.type === 'navigation') {
                window.parent.postMessage(event.data, '*');
            }
        });

        function navigateTo(page) {
            // 向父窗口发送消息
            window.parent.postMessage({
                type: 'navigation',
                page: page
            }, '*');
        }

        // 标签管理弹窗
        function showTagDialog() {
            document.getElementById('tagDialog').classList.remove('hidden');
        }

        function closeTagDialog() {
            document.getElementById('tagDialog').classList.add('hidden');
        }
    </script>
</body>
</html> 